# MetroPulse - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

[![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)](https://www.python.org/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue.svg)](https://www.postgresql.org/)
[![Apache Spark](https://img.shields.io/badge/Apache%20Spark-3.4-orange.svg)](https://spark.apache.org/)
[![Docker](https://img.shields.io/badge/Docker-required-blue.svg)](https://www.docker.com/)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**MetroPulse** - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –¥–≤–∏–∂–µ–Ω–∏–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –ë–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏

- üìä **–î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤**: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –ø–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º
- üìà **–î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤**: –û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã —Å —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π –≤ –≥–æ—Ä–æ–¥–µ
- ü§ñ **–î–ª—è Data Scientists**: –î–æ—Å—Ç—É–ø –∫ –æ—á–∏—â–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º –¥–ª—è ML –º–æ–¥–µ–ª–µ–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

1. **Kafka Stream (vehicle_positions)** 
   - –ß–∞—Å—Ç–æ—Ç–∞: –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
   - –û–±—ä–µ–º: ~8.6M —Å–æ–±—ã—Ç–∏–π/–¥–µ–Ω—å
   - –î–∞–Ω–Ω—ã–µ: GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Å–∫–æ—Ä–æ—Å—Ç—å, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å

2. **PostgreSQL OLTP**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: ~100K –∞–∫—Ç–∏–≤–Ω—ã—Ö
   - –ü–æ–µ–∑–¥–∫–∏: ~500K –≤ –¥–µ–Ω—å
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –º–∞—Ä—à—Ä—É—Ç—ã, —Å—Ç–∞–Ω—Ü–∏–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

```
Sources ‚Üí Staging ‚Üí Core DWH ‚Üí Data Marts ‚Üí BI Tools
   ‚Üì         ‚Üì          ‚Üì           ‚Üì          ‚Üì
 OLTP     MinIO    PostgreSQL  ClickHouse  Dashboards
 Kafka              (Star)      Redis
```

- **Staging Layer**: MinIO (S3) + PostgreSQL staging tables
- **Core DWH**: Star Schema (Kimball) —Å SCD Type 2
- **Batch Processing**: Apache Spark –¥–ª—è ETL
- **Stream Processing**: Apache Flink –¥–ª—è real-time
- **Data Marts**: ClickHouse (batch) / Redis (real-time)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
databaseProject/
‚îú‚îÄ‚îÄ docs/                          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md           # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ data_sources.md           # –û–ø–∏—Å–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ presentation.pptx         # –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ stage1_dwh_design/            # –≠—Ç–∞–ø 1: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DWH
‚îÇ   ‚îú‚îÄ‚îÄ ddl/                      # DDL —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staging/              # Staging —Ç–∞–±–ª–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ core/                 # Core DWH —Ç–∞–±–ª–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ diagrams/
‚îÇ   ‚îî‚îÄ‚îÄ oltp_schema.sql
‚îú‚îÄ‚îÄ stage2_batch_pipeline/        # –≠—Ç–∞–ø 2: Batch –ø–∞–π–ø–ª–∞–π–Ω
‚îÇ   ‚îú‚îÄ‚îÄ spark_jobs/               # Spark –¥–∂–æ–±—ã
‚îÇ   ‚îú‚îÄ‚îÄ data_generators/          # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ airflow_dags/
‚îú‚îÄ‚îÄ stage3_marts/                 # –≠—Ç–∞–ø 3: –í–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ option_a_batch/           # –í–∞—Ä–∏–∞–Ω—Ç –ê: ClickHouse
‚îÇ   ‚îî‚îÄ‚îÄ option_b_stream/          # –í–∞—Ä–∏–∞–Ω—Ç –ë: Flink + Redis
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îú‚îÄ‚îÄ scripts/
‚îî‚îÄ‚îÄ requirements.txt
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose
- Python 3.9+
- Java 11+ (–¥–ª—è Spark)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
docker-compose up -d
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—ã DWH:
```bash
python scripts/init_dwh.py
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç—å batch –ø–∞–π–ø–ª–∞–π–Ω:
```bash
python scripts/run_batch_pipeline.py
```

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DWH
- –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏: Kimball (Dimensional Modeling)
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å—Ö–µ–º—ã "–∑–≤–µ–∑–¥–∞"
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SCD Type 2 –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
- DDL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü

### –≠—Ç–∞–ø 2: Batch –ø–∞–π–ø–ª–∞–π–Ω
- Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Spark, PostgreSQL, MinIO)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ETL –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ PySpark
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ DWH —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SCD Type 2

### –≠—Ç–∞–ø 3: –í–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö
- **–í–∞—Ä–∏–∞–Ω—Ç –ê**: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∏—Ç—Ä–∏–Ω—ã –≤ ClickHouse
- **–í–∞—Ä–∏–∞–Ω—Ç –ë**: Real-time –≤–∏—Ç—Ä–∏–Ω–∞ —Å Flink –∏ Redis

### –≠—Ç–∞–ø 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞
- –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **DWH**: PostgreSQL 15 / Greenplum
- **Batch Processing**: Apache Spark 3.4 (PySpark)
- **Stream Processing**: Apache Flink 1.17
- **Message Queue**: Apache Kafka 3.5
- **Object Storage**: MinIO (S3-compatible)
- **Analytics DB**: ClickHouse 23.8
- **In-Memory DB**: Redis 7.2
- **Orchestration**: Apache Airflow 2.7 (–æ–ø–∏—Å–∞–Ω–∏–µ)
- **Language**: Python 3.9+

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–æ–π Data-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ MetroPulse.

